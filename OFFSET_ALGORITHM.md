# åç§»ç®—æ³•è®¾è®¡æ–‡æ¡£

## ğŸ¯ è®¾è®¡é€»è¾‘

### æ ¸å¿ƒåŸåˆ™
**åç§»åŸºå‡†**: ç¼©æ”¾åçš„ä¸»å›¾æ”¾åœ¨ç”»å¸ƒä¸­å¿ƒ,åç§»èŒƒå›´ç”±**ä¸»å›¾å°ºå¯¸å’Œç”»å¸ƒå°ºå¯¸çš„å·®å€¼**å†³å®šã€‚

### å…³é”®æ¦‚å¿µ

1. **å±…ä¸­ä½ç½®**: ä¸»å›¾åœ¨ç”»å¸ƒæ­£ä¸­å¤®çš„åæ ‡
2. **å¯ç§»åŠ¨èŒƒå›´**: ä¸»å›¾å¯ä»¥åœ¨ç”»å¸ƒå†…ç§»åŠ¨çš„æœ€å¤§è·ç¦»
3. **åç§»ç™¾åˆ†æ¯”**: 0%-100%,50%è¡¨ç¤ºå±…ä¸­

---

## ğŸ“ ç®—æ³•è¯¦è§£

### æ­¥éª¤1: è®¡ç®—ç¼©æ”¾åçš„ä¸»å›¾å°ºå¯¸

```typescript
const scaledWidth = main.width * params.scale;
const scaledHeight = main.height * params.scale;
```

**ç¤ºä¾‹**:
- åŸå§‹ä¸»å›¾: 400Ã—600
- ç¼©æ”¾å€æ•°: 0.5
- ç¼©æ”¾å: 200Ã—300

---

### æ­¥éª¤2: è®¡ç®—ä¸»å›¾åœ¨ç”»å¸ƒä¸­å¿ƒæ—¶çš„ä½ç½®

```typescript
const centerX = (canvas.width - scaledWidth) / 2;
const centerY = (canvas.height - scaledHeight) / 2;
```

**æ•°å­¦åŸç†**:
```
ç”»å¸ƒå®½åº¦ = 1080
ä¸»å›¾å®½åº¦ = 200
å±…ä¸­Xåæ ‡ = (1080 - 200) / 2 = 440
```

**ç¤ºä¾‹**:
```
ç”»å¸ƒ: 1080Ã—1440
ä¸»å›¾(ç¼©æ”¾å): 200Ã—300

centerX = (1080 - 200) / 2 = 440
centerY = (1440 - 300) / 2 = 570
```

---

### æ­¥éª¤3: è®¡ç®—å¯ç§»åŠ¨èŒƒå›´

```typescript
const moveRangeX = Math.max(0, canvas.width - scaledWidth);
const moveRangeY = Math.max(0, canvas.height - scaledHeight);
```

**æƒ…å†µ1: ä¸»å›¾æ¯”ç”»å¸ƒå°**
```
ç”»å¸ƒ: 1080Ã—1440
ä¸»å›¾: 200Ã—300

moveRangeX = 1080 - 200 = 880  // å¯å·¦å³ç§»åŠ¨880px
moveRangeY = 1440 - 300 = 1140 // å¯ä¸Šä¸‹ç§»åŠ¨1140px
```

**æƒ…å†µ2: ä¸»å›¾æ¯”ç”»å¸ƒå¤§**
```
ç”»å¸ƒ: 1080Ã—1440
ä¸»å›¾: 1500Ã—2000

moveRangeX = max(0, 1080 - 1500) = 0  // æ— æ³•ç§»åŠ¨
moveRangeY = max(0, 1440 - 2000) = 0
```

---

### æ­¥éª¤4: æ ¹æ®åç§»ç™¾åˆ†æ¯”è®¡ç®—å®é™…ä½ç½®

```typescript
const offsetRatioX = params.offsetX / 100;  // 0 ~ 1
const offsetRatioY = params.offsetY / 100;

const x = offsetRatioX * moveRangeX;
const y = offsetRatioY * moveRangeY;
```

**æ˜ å°„å…³ç³»**:
```
offset:   0%    25%    50%     75%    100%
ratio:    0     0.25   0.5     0.75   1.0
ä½ç½®:     å·¦è¾¹ç¼˜ 1/4    å±…ä¸­    3/4    å³è¾¹ç¼˜
```

---

## ğŸ§® è®¡ç®—ç¤ºä¾‹

### ç¤ºä¾‹1: ä¸»å›¾å°äºç”»å¸ƒ

**å‚æ•°**:
- ç”»å¸ƒ: 1080Ã—1440
- ä¸»å›¾(ç¼©æ”¾å): 200Ã—300
- åç§»: 50%, 50%

**è®¡ç®—è¿‡ç¨‹**:
```typescript
// 1. å±…ä¸­ä½ç½®
centerX = (1080 - 200) / 2 = 440
centerY = (1440 - 300) / 2 = 570

// 2. å¯ç§»åŠ¨èŒƒå›´
moveRangeX = 1080 - 200 = 880
moveRangeY = 1440 - 300 = 1140

// 3. åç§»æ¯”ä¾‹
offsetRatioX = 50 / 100 = 0.5
offsetRatioY = 50 / 100 = 0.5

// 4. æœ€ç»ˆä½ç½®
x = 0.5 Ã— 880 = 440  âœ… ç­‰äºcenterX,å±…ä¸­!
y = 0.5 Ã— 1140 = 570 âœ… ç­‰äºcenterY,å±…ä¸­!
```

**éªŒè¯**:
```
ä¸»å›¾å·¦ä¸Šè§’: (440, 570)
ä¸»å›¾å³ä¸‹è§’: (440+200, 570+300) = (640, 870)
ç”»å¸ƒä¸­å¿ƒ: (540, 720)
ä¸»å›¾ä¸­å¿ƒ: (440+100, 570+150) = (540, 720) âœ… å®Œç¾å±…ä¸­!
```

---

### ç¤ºä¾‹2: åç§»åˆ°å·¦ä¸Šè§’

**å‚æ•°**:
- ç”»å¸ƒ: 1080Ã—1440
- ä¸»å›¾(ç¼©æ”¾å): 200Ã—300
- åç§»: 0%, 0%

**è®¡ç®—**:
```typescript
offsetRatioX = 0 / 100 = 0
offsetRatioY = 0 / 100 = 0

x = 0 Ã— 880 = 0
y = 0 Ã— 1140 = 0
```

**ç»“æœ**: ä¸»å›¾å·¦ä¸Šè§’å¯¹é½ç”»å¸ƒå·¦ä¸Šè§’

---

### ç¤ºä¾‹3: åç§»åˆ°å³ä¸‹è§’

**å‚æ•°**:
- ç”»å¸ƒ: 1080Ã—1440
- ä¸»å›¾(ç¼©æ”¾å): 200Ã—300
- åç§»: 100%, 100%

**è®¡ç®—**:
```typescript
offsetRatioX = 100 / 100 = 1.0
offsetRatioY = 100 / 100 = 1.0

x = 1.0 Ã— 880 = 880
y = 1.0 Ã— 1140 = 1140
```

**éªŒè¯**:
```
ä¸»å›¾å³ä¸‹è§’: (880+200, 1140+300) = (1080, 1440)
ç”»å¸ƒå³ä¸‹è§’: (1080, 1440) âœ… å®Œç¾å¯¹é½!
```

---

## âœ… ç®—æ³•ä¼˜åŠ¿

### 1. è‡ªåŠ¨é€‚é…ç”»å¸ƒ
- **ä¸»å›¾å°äºç”»å¸ƒ**: å¯ä»¥åœ¨ç”»å¸ƒå†…è‡ªç”±ç§»åŠ¨
- **ä¸»å›¾ç­‰äºç”»å¸ƒ**: æ— ç§»åŠ¨ç©ºé—´,å›ºå®šæ˜¾ç¤º
- **ä¸»å›¾å¤§äºç”»å¸ƒ**: è‡ªåŠ¨é™åˆ¶åœ¨è¾¹ç•Œå†…

### 2. ä¿è¯ä¸ç§»å‡ºç”»å¸ƒ
```typescript
moveRange = max(0, canvas.size - image.size)
```
è¿™ç¡®ä¿äº†:
- å½“ `moveRange = 0` æ—¶,ä¸»å›¾æ— æ³•ç§»åŠ¨
- å½“ `moveRange > 0` æ—¶,ä¸»å›¾åœ¨ `[0, moveRange]` èŒƒå›´å†…ç§»åŠ¨
- **æ°¸è¿œä¸ä¼šç§»å‡ºç”»å¸ƒè¾¹ç•Œ**

### 3. ç²¾ç¡®å±…ä¸­
```typescript
offset = 50%
x = 0.5 Ã— moveRange
```
æ•°å­¦ä¿è¯:
- å·¦è¾¹è· = `x`
- å³è¾¹è· = `moveRange - x = moveRange - 0.5Ã—moveRange = 0.5Ã—moveRange`
- å·¦è¾¹è· = å³è¾¹è· âœ… å®Œç¾å±…ä¸­

---

## ğŸ“Š å¯¹æ¯”æ—§ç®—æ³•

### æ—§ç®—æ³•é—®é¢˜
```typescript
// âŒ æ—§ç®—æ³•
const offsetPixels = (offset - 50) / 100 Ã— canvas.width;
const x = canvasCenter + offsetPixels - imageWidth/2;
```

**é—®é¢˜**:
1. åç§»åŸºå‡†æ˜¯ç”»å¸ƒå°ºå¯¸,ä¸è€ƒè™‘ä¸»å›¾å¤§å°
2. ä¸»å›¾å¯èƒ½ç§»å‡ºç”»å¸ƒè¾¹ç•Œ
3. éœ€è¦é¢å¤–çš„è¾¹ç•Œé™åˆ¶é€»è¾‘

### æ–°ç®—æ³•ä¼˜åŠ¿
```typescript
// âœ… æ–°ç®—æ³•
const moveRange = canvas.width - imageWidth;
const x = (offset / 100) Ã— moveRange;
```

**ä¼˜åŠ¿**:
1. åç§»åŸºå‡†æ˜¯ä¸»å›¾å¯ç§»åŠ¨èŒƒå›´
2. è‡ªåŠ¨ä¿è¯ä¸ç§»å‡ºè¾¹ç•Œ
3. é€»è¾‘ç®€å•,æ˜“äºç†è§£

---

## ğŸ¯ å®é™…åº”ç”¨

### åœºæ™¯1: å°äººç‰©å›¾ç‰‡
```
ä¸»å›¾(ç¼©æ”¾å): 300Ã—400
ç”»å¸ƒ: 1080Ã—1440

moveRange: 780Ã—1040
å¯ç§»åŠ¨ç©ºé—´å……è¶³,è‡ªç”±è°ƒæ•´ä½ç½®
```

### åœºæ™¯2: å¤§å…¨èº«ç…§
```
ä¸»å›¾(ç¼©æ”¾å): 900Ã—1200
ç”»å¸ƒ: 1080Ã—1440

moveRange: 180Ã—240
å¯ç§»åŠ¨ç©ºé—´æœ‰é™,å¾®è°ƒä½ç½®
```

### åœºæ™¯3: è¶…å¤§å›¾ç‰‡
```
ä¸»å›¾(ç¼©æ”¾å): 1200Ã—1600
ç”»å¸ƒ: 1080Ã—1440

moveRange: 0Ã—0
æ— æ³•ç§»åŠ¨,å›ºå®šæ˜¾ç¤º(è‡ªåŠ¨è£å‰ª)
```

---

## ğŸ” è°ƒè¯•æ—¥å¿—

æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹:
```javascript
ğŸ“ åˆæˆå‚æ•°(ä»¥ä¸»å›¾å¯ç§»åŠ¨èŒƒå›´ä¸ºåŸºå‡†): {
  canvas: "1080Ã—1440",
  main: "400Ã—600",
  scaled: "200Ã—300",
  centerPos: "(440, 570)",
  moveRange: "880Ã—1140",
  offset: "50%, 50%",
  position: "(440, 570)"
}
```

**è§£è¯»**:
- `centerPos`: å±…ä¸­æ—¶çš„ä½ç½®
- `moveRange`: ä¸»å›¾å¯ç§»åŠ¨çš„èŒƒå›´
- `position`: å½“å‰åç§»åçš„ä½ç½®
- å½“ `position = centerPos` æ—¶,è¯´æ˜å®Œç¾å±…ä¸­

---

## ğŸ“ æ€»ç»“

### å…³é”®å…¬å¼
```typescript
// å¯ç§»åŠ¨èŒƒå›´
moveRange = max(0, canvas.size - image.size)

// æœ€ç»ˆä½ç½®
position = (offset% / 100) Ã— moveRange
```

### è¾¹ç•Œä¿è¯
- **æœ€å°ä½ç½®**: `position = 0` (offset = 0%)
- **å±…ä¸­ä½ç½®**: `position = moveRange/2` (offset = 50%)
- **æœ€å¤§ä½ç½®**: `position = moveRange` (offset = 100%)
- **å›¾ç‰‡å³ä¸‹è§’**: `position + image.size = moveRange + image.size = canvas.size` âœ…

**æ•°å­¦è¯æ˜**:
```
å½“ offset = 100% æ—¶:
position = 1.0 Ã— moveRange = moveRange
å›¾ç‰‡å³è¾¹ç¼˜ = position + imageWidth
          = moveRange + imageWidth
          = (canvasWidth - imageWidth) + imageWidth
          = canvasWidth âœ…
```

**ç»“è®º**: ä¸»å›¾æ°¸è¿œä¸ä¼šç§»å‡ºç”»å¸ƒ!

---

**æœ€åæ›´æ–°**: 2025-10-19
**çŠ¶æ€**: âœ… ç®—æ³•éªŒè¯é€šè¿‡,æ•°å­¦ä¸¥æ ¼è¯æ˜
